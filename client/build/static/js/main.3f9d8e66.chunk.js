(this["webpackJsonpFILMAG-EKOPAK-React"]=this["webpackJsonpFILMAG-EKOPAK-React"]||[]).push([[0],{131:function(e,t,a){e.exports=a.p+"static/media/logo_eduLEAN.9308f86e.png"},181:function(e,t,a){e.exports=a.p+"static/media/logo_ekopak.a0b89b36.png"},183:function(e,t,a){e.exports=a(429)},426:function(e,t,a){},429:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(69),o=a.n(s),i=a(12),c=a(13),u=a(15),l=a(14),d=a(16),m=a(434),p=a(431),f=a(433),b=a(4),h=a(92),v=a.n(h),_=a(2),g=a.n(_),k=a(77),y=a(430),E=function(e){var t=e.label,a=e.path,n=e.icon;return r.a.createElement(y.a,{to:a},r.a.createElement("li",{className:"app__header-menu_item app__header-menu_item-main"},r.a.createElement("i",{className:"fa fas "+n}),r.a.createElement("p",null,t)))},w=function(e){var t=e.item,a=e.action;return r.a.createElement(y.a,{to:t.path},r.a.createElement("li",{className:"app__header-menu_item",onClick:a},t.category&&function(){var e;return"Magazyn"===t.category?e="cubes":"Maszyna"===t.category?e="cubes invisible":"Utrzymanie ruchu"===t.category&&(e="wrench"),r.a.createElement("i",{className:"fa fas fa-"+e})}(),t.name||t.label))},x=function(e){var t=e.items,a=e.action;return t.map((function(e){return r.a.createElement(w,{key:e.name||e.label,item:e,action:function(){return a(e)}})}))},T=a(8),j=a(11),O=a.n(j),N=a(46);var C={runFunctionAfterPressEnter:function(e,t){13===e.charCode&&t()},getCustomTaskCss:function(e,t){return"#"===e?"task-box__"+t+"_index":"content"===e?"task-box__"+t+"_content":"status"===e?"task-box__"+t+"_status":"qty"===e?"task-box__"+t+"_qty":"partialQty"===e?"task-box__"+t+"_partialQty":"location"===e?"task-box__"+t+"_location":"time"===e?"task-box__"+t+"_time":"take"===e?"task-box__"+t+"_take":"btnClose"===e?"task-box__"+t+"_btnClose":"takedBy"===e?"task-box__"+t+"_takedBy":"createdInFormatedData"===e?"task-box__"+t+"_createdInFormatedData":"btnDelete"===e?"task-box__"+t+"_btnDelete":void 0},getDateFromTaskCreatedIn:function(e){return e.slice(0,10)},getTimeFromTaskCreatedIn:function(e){return e.slice(11,19)}},M=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).state={},a.handleInputOnChange=function(e){var t=e.currentTarget,n=Object(T.a)({},a.state.item);n[t.name]=t.value,a.setState({item:n})},a.validate=function(e){var t=O.a.validate(e,a.schema).error;return t?t.details[0].message:null},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"renderInputBoxGroup",value:function(e,t,a,n,s,o){var i=this,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:this.handleInputOnChange;return r.a.createElement("div",{className:"confirmAlertInput__input-box_group"},r.a.createElement("p",null,e),r.a.createElement("input",{name:t,type:a,placeholder:n,autoComplete:"off",autoFocus:o,onChange:c,onKeyPress:function(e){return C.runFunctionAfterPressEnter(e,(function(){return i.doSubmit(s)}))}}))}},{key:"renderInputCustomSelect",value:function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.handleInputOnChange;return r.a.createElement("div",{className:"confirmAlertInput__input-box_group"},r.a.createElement("p",null,e),r.a.createElement("select",{className:"custom-select","data-style":"btn-primary",name:a,onChange:s,defaultValue:n},t.map((function(e){return r.a.createElement("option",{key:e,value:e},e)}))))}},{key:"renderButton",value:function(e,t,a){return r.a.createElement("button",{className:a,onClick:t},e)}}]),t}(n.Component),z=a(47),U=a.n(z),I={auth:"/auth",users:"/users",localisations:"/localisations",tasks:"/tasks",getExcelFileWithTasks:"/getExcelFile"},S=I.auth,D="FilmagToken";var L={login:function(e,t){var a,n;return g.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,g.a.awrap(F.post(S,{name:e,password:t}));case 2:return a=r.sent,n=a.data,r.abrupt("return",n);case 5:case"end":return r.stop()}}))},shortIdentification:function(e,t){var a,n;return g.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,g.a.awrap(F.post(S+"/shortIdentification/",{idCode:e,pin:t}));case 2:return a=r.sent,n=a.data,r.abrupt("return",n);case 5:case"end":return r.stop()}}))},setJwt:function(e){return localStorage.setItem(D,e)},getJwt:function(){return localStorage.getItem(D)},removeJwt:function(){localStorage.removeItem(D)}};U.a.defaults.baseURL="http://localhost:8080/api",A(L.getJwt());var P=0;function A(e){U.a.defaults.headers.common["x-auth-token"]=e}U.a.interceptors.response.use(null,(function(e){return e.response&&e.response.status>=400&&e.response.status<500||0!==P||(P+=1,b.toast.error("Brak po\u0142\u0105czenia z serwerem."),setTimeout((function(){P=0}),2e3)),Promise.reject(e)}));var F={get:U.a.get,post:U.a.post,put:U.a.put,patch:U.a.patch,delete:U.a.delete,setHeader_xAuthToken:A},B=I.users,R={SuperAdmin:1e3,Admin:100,Prezes:14,Dyrektor:13,Kierownik:12,Mistrz:11,Koordynator:10,"Wsp\xf3\u0142dzielone":4,"Prac. utrz. ruchu":3,Magazynier:2,Operator:1};function q(){var e=L.getJwt();return e?v()(e):void 0}function G(e){var t=q();return!!t&&J(t.job)>=R[e]}function J(e){return R[e]}var W={endpoint:B,getJobNames:function(){return Object.keys(R)},getUsers:function(){var e,t,a;return g.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return e=G("Admin"),n.next=3,g.a.awrap(F.get(B));case 3:return t=n.sent,a=t.data,a=(a=e?a:a.filter((function(e){return"Admin"!==e.job&&"SuperAdmin"!==e.job}))).sort((function(e,t){return J(t.job)-J(e.job)})),n.abrupt("return",a);case 8:case"end":return n.stop()}}))},addUser:function(e){var t,a;return g.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,g.a.awrap(F.post(B,e));case 2:return t=n.sent,a=t.data,n.abrupt("return",a);case 5:case"end":return n.stop()}}))},updateUser:function(e){var t,a;return g.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,g.a.awrap(F.put(B+"/"+e._id,e));case 2:return t=n.sent,a=t.data,n.abrupt("return",a);case 5:case"end":return n.stop()}}))},deleteUser:function(e){var t,a;return g.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,g.a.awrap(F.delete(B+"/"+e._id));case 2:return t=n.sent,a=t.data,n.abrupt("return",a);case 5:case"end":return n.stop()}}))},logoutUser:function(){var e;return g.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return e=q(),t.next=3,g.a.awrap(F.patch(B+"/"+e._id,{isLogged:!1}));case 3:case"end":return t.stop()}}))},resetUserPassword:function(e){var t,a;return g.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,g.a.awrap(F.patch("/resetPassword/"+e._id,{password:e.password,newPassword:e.newPassword}));case 2:return t=n.sent,a=t.data,n.abrupt("return",a);case 5:case"end":return n.stop()}}))},resetUserPIN:function(e){var t,a;return g.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,g.a.awrap(F.patch("/resetPassword/"+e._id,{password:e.password,newPIN:e.newPIN}));case 2:return t=n.sent,a=t.data,n.abrupt("return",a);case 5:case"end":return n.stop()}}))},getUserFromJWT:q,getUserJobName:function(e){for(var t in R)if(R[t]===e.job)return t},getUserJobValue:J,isCurrentUserLessThan:function(e){return J(q().job)<R[e]},isCurrentUserLessThanORequalTo:function(e){return J(q().job)<=R[e]},isCurrentUserGreaterThan:function(e){return J(q().job)>R[e]},isCurrentUserGreaterThanORequalTo:G,isCurrentUserEqualTo:function(e){return J(q().job)===R[e]},isThisJobManaging:function(e){return J(e)>=R.Koordynator}},K={tasks:{main:"/show-tasks",paramId:"/show-tasks/:id"},home:"/",loginPage:"/login",noPermissions:"/no-permissions",selectLocalisation:"/select-localisation",getExcelFileWithTasks:"/getExcelFile",settings:{main:"/settings",user:"/settings/user",users:"/settings/users",localisations:"/settings/localisations"}},H=I.localisations,Z="userLocalisations",V={Magazyn:3,"Utrzymanie ruchu":2,Maszyna:1};function Q(){var e=localStorage.getItem(Z);return e?JSON.parse(e):[]}var X={getLocalisationNames:function(){return Object.keys(V)},getLocalisations:function(){var e,t;return g.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,g.a.awrap(F.get(H));case 3:return e=a.sent,t=e.data,a.abrupt("return",t);case 8:a.prev=8,a.t0=a.catch(0),b.toast.error("Nie mo\u017cna uzyska\u0107 danych o lokalizacjach.");case 11:case"end":return a.stop()}}),null,null,[[0,8]])},setUserLocalisations:function(e){e.forEach((function(e){return e.path="".concat(K.tasks.main,"/").concat(e.name)}));var t=JSON.stringify(e);localStorage.setItem(Z,t)},getCurrentUserLocalisations:Q,getUserLocalisationsFromDB:function(e){var t,a;return g.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,g.a.awrap(F.get(W.endpoint+"/"+e._id+"/localisations"));case 2:return t=n.sent,a=t.data,n.abrupt("return",a);case 5:case"end":return n.stop()}}))},addLocalisation:function(e){var t,a;return g.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,g.a.awrap(F.post(H,e));case 2:return t=n.sent,a=t.data,n.abrupt("return",a);case 5:case"end":return n.stop()}}))},updateLocalisation:function(e){var t,a;return g.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,g.a.awrap(F.put(H+"/"+e._id,e));case 2:return t=n.sent,a=t.data,n.abrupt("return",a);case 5:case"end":return n.stop()}}))},deleteLocalisation:function(e){var t,a;return g.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,g.a.awrap(F.delete(H+"/"+e._id));case 2:return t=n.sent,a=t.data,n.abrupt("return",a);case 5:case"end":return n.stop()}}))},getSelectedLocalisation:function(e){var t;return g.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,g.a.awrap(Q());case 2:return t=a.sent,a.abrupt("return",e?t.filter((function(t){return t.name===e}))[0]:null);case 4:case"end":return a.stop()}}))},getCurrentLocalisation:function(e){var t,a;return g.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,g.a.awrap(Q());case 2:return t=n.sent,a=t.filter((function(t){return t.path===e})),n.abrupt("return",a[0]?a[0]:t[0]);case 5:case"end":return n.stop()}}))},sortLocalisationsOrder:function(e){return e.sort((function(e,t){return e.order_number-t.order_number}))}},Y=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(a=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(s)))).schema={content:O.a.string().max(40).required().error((function(){return{message:a.errorMessages.content}})),type:O.a.string().required(),createdBy:O.a.string(),location:O.a.string().required().error((function(){return{message:a.errorMessages.location}})),qty:O.a.number().min(1).max(99999).required().error((function(){return{message:a.errorMessages.qty}}))},a.errorMessages={content:"Tre\u015b\u0107 zdarzenia nie mo\u017ce by\u0107 pusta i mo\u017ce mie\u0107 maks. 40 znak\xf3w",qty:'Pole "Ilo\u015b\u0107" nie mo\u017ce by\u0107 puste a warto\u015b\u0107 by\u0107 liczb\u0105 z zakresu 1 - 9999',location:"Prosz\u0119 poda\u0107 lokalizacj\u0119",idCode:"Nieprawid\u0142owy kod ID",pin:"Nieprawid\u0142owy PIN"},a.isCommonUser=W.getUserFromJWT().isCommonUser,a.submit=function(){a.resetOnlyCommonUserData(),Object(N.confirmAlert)({customUI:function(e){var t=e.onClose,n=a.props.form,s=n.title,o=n.content,i=n.p_label,c=n.p_label_2,u=a.state.item,l=u.content||o,d=u.qty,m=W.getUserFromJWT(),p=X.getCurrentUserLocalisations();return m.isCommonUser&&(p=p.filter((function(e){return"Magazyn"!==e.category})).map((function(e){return e.name}))).unshift(""),r.a.createElement("div",{className:"confirmAlertInput"},r.a.createElement("h1",null,s),r.a.createElement("div",{className:"confirmAlertInput__input-box"},m.isCommonUser&&a.renderInputCustomSelect("Gdzie",p,"location",a.state.item.location),a.renderInputBoxGroup(i,"content","text",l,t,"autoFocus"),c&&a.renderInputBoxGroup(c,"qty","number",d,t),m.isCommonUser&&a.renderInputBoxGroup("Kod ID","idCode","text","Tw\xf3j kod ID",t),m.isCommonUser&&a.renderInputBoxGroup("PIN","pin","number","Podaj PIN",t)),r.a.createElement("div",{className:"confirmAlertInput__button-group"},a.renderButton("Dodaj",(function(){return a.doSubmit(t)})),a.renderButton("Anuluj",t)))}})},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t={content:this.props.form.content,type:this.props.button.type,qty:1,location:this.props.localisation.name,createdBy:W.getUserFromJWT().name};this.setState({item:t}),this.isCommonUser&&(this.schema.idCode=O.a.string().min(3).max(3).required().error((function(){return{message:e.errorMessages.idCode}})),this.schema.pin=O.a.string().min(4).max(4).required().error((function(){return{message:e.errorMessages.pin}})))}},{key:"addQtyToSchema",value:function(){var e=this;return this.schema.qty=O.a.number().min(1).max(99999).required().error((function(){return{message:e.errorMessages.qty}}))}},{key:"resetOnlyCommonUserData",value:function(){var e=Object(T.a)({},this.state.item);delete e.idCode,delete e.pin,this.setState({item:e})}},{key:"resetTaskData",value:function(){var e=Object(T.a)({},this.state.item);e.content=this.props.form.content,e.qty=1,this.isCommonUser&&(e.location=""),this.setState({item:e})}},{key:"doSubmit",value:function(e){var t,a,n;return g.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(t=this.state.item,!(a=this.validate(t))){r.next=5;break}return b.toast.error(a),r.abrupt("return",null);case 5:if(this.isCommonUser){r.next=11;break}this.props.form.action(t),this.resetTaskData(),e(),r.next=28;break;case 11:return r.prev=11,e(),t.idCode=t.idCode.toUpperCase(),r.next=16,g.a.awrap(L.shortIdentification(t.idCode,t.pin));case 16:n=r.sent,t.createdBy=n.name,delete t.idCode,delete t.pin,this.props.form.action(t),this.resetTaskData(),r.next=28;break;case 24:r.prev=24,r.t0=r.catch(11),r.t0.response&&b.toast.error("Nieprawid\u0142owy kod ID lub PIN"),this.submit();case 28:case"end":return r.stop()}}),null,this,[[11,24]])}},{key:"render",value:function(){return r.a.createElement("div",{className:"app__header_headerButtons-wrap"},this.renderButton(this.props.button.label,this.submit,"btn btn-secondary"))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=t.item&&e.localisation.name!==t.item.location.name,n=W.getUserFromJWT().isCommonUser;return a&&!n?{item:Object(T.a)({},t.item,{location:e.localisation.name})}:null}}]),t}(M),$=a(17),ee=I.tasks;var te={getTasks:function(){var e,t;return g.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,g.a.awrap(F.get(ee));case 3:return e=a.sent,t=e.data,"visible"===document.visibilityState&&localStorage.setItem("lastActivityTime",(new Date).getTime()),a.abrupt("return",t);case 9:if(a.prev=9,a.t0=a.catch(0),!a.t0||423!==a.t0.response.status){a.next=14;break}a.next=16;break;case 14:return b.toast.error("Nie mo\u017cna uzyska\u0107 danych o zdarzeniach."),a.abrupt("return",[]);case 16:case"end":return a.stop()}}),null,null,[[0,9]])},addTask:function(e){var t,a;return g.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,g.a.awrap(F.post(ee,e));case 2:return t=n.sent,a=t.data,n.abrupt("return",a);case 5:case"end":return n.stop()}}))},updateTask:function(e){var t,a;return g.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,g.a.awrap(F.put(ee+"/"+e._id,e));case 2:return t=n.sent,a=t.data,n.abrupt("return",a);case 5:case"end":return n.stop()}}))},deleteTask:function(e){var t,a;return g.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,g.a.awrap(F.delete(ee+"/"+e._id));case 2:return t=n.sent,a=t.data,n.abrupt("return",a);case 5:case"end":return n.stop()}}))},getSortedData:function(e,t){var a,n,r=t.reducerTasks,s=t.reducerLocalisations;return a=e,e=function(e,t){return"All"===t?e:e.filter((function(e){return e.isDone===t}))}(e="Magazyn"===(n=s.currentLocalisation).category?a:"Utrzymanie ruchu"===n.category?a.filter((function(e){return"breakdown"===e.type})):a.filter((function(e){return e.location===n.name})),r.currentSortingStatus)},getFilteredColumns:function(e,t){var a=t.reducerServiceMode,n=function(e){var t=a.serviceMode_jobName;return"Koordynator"===e?W.getUserJobValue(t)>=W.getUserJobValue(e):t===e},r=t.reducerLocalisations.currentLocalisation,s=a.serviceMode,o=a.serviceMode_jobName,i=a.managerMode,c=W.isThisJobManaging(o),u=Object($.a)(e.common);return u.push(e.special.column_takedBy),(s?n("Magazynier"):W.isCurrentUserEqualTo("Magazynier"))&&u.push(e.special.column_take),(s?n("Operator"):W.isCurrentUserEqualTo("Operator"))&&u.push(e.special.column_btnClose),"Utrzymanie ruchu"!==r.category&&(s?n("Koordynator"):W.isCurrentUserGreaterThanORequalTo("Koordynator"))&&u.push(e.special.column_createdInFormatedData),(s?c&&i:i)&&(u.push(e.special.column_btnClose),u.push(e.special.column_btnDelete)),(s?n("Magazynier"):W.isCurrentUserEqualTo("Magazynier"))&&u.push(e.special.column_btnClose),u}},ae=a(7),ne=function(e){return{type:"UPDATE_TASKS",tasks:e}},re=function(e){return{type:"CHANGE_CURRENT_SORTING_STATUS",currentSortingStatus:e}},se=function(e){return{type:"TOGGLE_CHOOSE_MANY_TASKS_MODE",chooseManyTasksMode:e}},oe=function(e){return{type:"UPDATE_CHOOSED_TASKS_FROM_MANAGER_MODE",selectedTasksIDs_fromManagerMode:e}},ie=Object(ae.b)((function(e){return e}),(function(e){return{updateTasks:function(t){return e(ne(t))}}}))((function(e){var t={title:"Dodaj zdarzenie",p_label:"Tre\u015b\u0107",btn_css:"btn btn-success btn-sm",action:function(t){return function(t){var a,n;return g.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,g.a.awrap(te.addTask(t));case 2:a=r.sent,(n=e.reducerTasks.tasks).unshift(a),e.updateTasks(n),b.toast.success("Dodano zdarzenie. Wpis pojawi si\u0119 w ci\u0105gu 10 sekund.",{transition:Object(b.cssTransition)({enter:"Toastify__zoom-enter",exit:"Toastify__zoom-exit",duration:[500,800]}),className:"position-absolute-center-center"});case 7:case"end":return r.stop()}}))}(t)}};return r.a.createElement(Y,{localisation:e.localisation,button:e.button,form:function(e){var a=Object(T.a)({},t);return a.content="Zam\xf3w formatk\u0119"===e.label?"":e.label,a.p_label_2="order"===e.type?"Ilo\u015b\u0107":"",a}(e.button)})})),ce=function(e){return{type:"TOGGLE_SERVICE_MODE",serviceMode:e}},ue=function(e){return{type:"CHANGE_SERVICE_MODE_JOB_NAME",serviceMode_jobName:e}},le=function(e){return{type:"TOGGLE_DELETE_TASK_MODE",managerMode:e}},de=function(e){return{type:"CHANGE_CURRENT_LOCALISATION",currentLocalisation:e}},me=Object(ae.b)((function(e){return e}),(function(e){return{toggleServiceMode:function(t){return e(ce(t))},changeServiceMode_jobName:function(t){return e(ue(t))},changeCurrentLocalisation:function(t){return e(de(t))}}}))((function(e){var t=Object(n.useState)(e.reducerLocalisations.currentLocalisation),a=Object(k.a)(t,2),s=a[0],o=a[1],i=Object(n.useState)(e.reducerServiceMode.serviceMode),c=Object(k.a)(i,2),u=c[0],l=c[1],d=function(t){o(t),e.changeCurrentLocalisation(t)},m=function(t){l(t),e.toggleServiceMode(t)},p=[{label:"Zam\xf3w formatk\u0119",type:"order"},{label:"Odbi\xf3r palet",type:"orderTakeout"},{label:"Awaria",type:"breakdown"},{label:"Przezbrojenie",type:"modelChange"},{label:"Czyszczenie",type:"cleaning"}],f=W.getJobNames();Object(n.useEffect)((function(){o(e.reducerLocalisations.currentLocalisation),l(e.reducerServiceMode.serviceMode)}),[e.reducerLocalisations.currentLocalisation,e.reducerServiceMode.serviceMode]);var b=W.isCurrentUserGreaterThanORequalTo("Koordynator"),h=W.getUserFromJWT().isCommonUser;return r.a.createElement("header",{className:"app__header"},u&&r.a.createElement("div",{className:"app__header_header-buttons-wrapper-service"},r.a.createElement("i",{className:"fa fas fa-cogs"}),r.a.createElement("div",{className:"app__header_headerButtons-service"},f.map((function(t){return r.a.createElement("button",{key:t,className:(a=t,a===e.reducerServiceMode.serviceMode_jobName?"btn btn-light btn-sm":"btn btn-outline-light btn-sm"),onClick:function(){return e.changeServiceMode_jobName(t)}},t);var a})))),("Maszyna"===s.category||h)&&r.a.createElement("div",{className:"app__header_header-buttons-wrapper"},r.a.createElement("i",{className:"fa fas fa-cart-arrow-down"}),r.a.createElement("div",{className:"app__header_headerButtons"},p.map((function(e){return r.a.createElement(ie,{key:e.label,localisation:s,button:e})})))),r.a.createElement("div",{className:"app__header_title-barIcon-wrapper"},r.a.createElement("div",{className:"app__header-title"},s.name),b&&function(){var e=X.getCurrentUserLocalisations(),t=W.isCurrentUserGreaterThanORequalTo("Admin");return r.a.createElement("div",{className:"app__header-barIcon  common-cursor-pointer"},r.a.createElement("i",{className:"fa far fa-bars fa-3x"}),r.a.createElement("ul",{className:"app__header-menu"},t&&function(){var e=u?"fa fa-toggle-on":"fa fa-toggle-off";return r.a.createElement("li",{className:"app__header-menu_item",onClick:function(){return m(!u)}},r.a.createElement("i",{className:e}),"Tryb testu widok\xf3w")}(),r.a.createElement(E,{label:"Ustawienia",path:K.settings.main,icon:"fa-cog"}),r.a.createElement(x,{items:e,action:d})))}()))})),pe=Object(ae.b)((function(e){return e}),(function(e){return{toggleManagerMode:function(t){return e(le(t))},toggleChooseManyTasksMode:function(t){return e(se(t))},updateChoosenTasksFromManagerMode:function(t){return e(oe(t))}}}))((function(e){var t=e.reducerServiceMode.managerMode,a=function(){e.toggleManagerMode(!t),t||(e.updateChoosenTasksFromManagerMode([]),e.toggleChooseManyTasksMode(!1))};return r.a.createElement("button",{className:(t?"btn-dark":"btn-outline-dark")+" btn btn-sm sorting-buttons-box_managerModeButton",onClick:function(){return a()}},t?"Wy\u0142\u0105cz tryb":"Tryb zarz\u0105dzania")})),fe=Object(ae.b)((function(e){return e}),(function(e){return{toggleChooseManyTasksMode:function(t){return e(se(t))}}}))((function(e){var t=e.reducerTasks.chooseManyTasksMode;return r.a.createElement("button",{className:(t?"btn-dark":"btn-outline-dark")+" btn btn-sm sorting-buttons-box_chooseManyTasksButton",onClick:function(){return e.toggleChooseManyTasksMode(!t)}},"Zaznacz wiele")})),be=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).state={},a.submit=function(){var e=a.props,t=e.item,n=e.itemRepresentation,r=a.props.form,s=r.title,o=r.action;Object(N.confirmAlert)({title:s,message:a.props.form.message||n,buttons:[{label:"Potwierdzam",onClick:function(){return o(t)}},{label:"Anuluj",onClick:function(){return null}}]})},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.form,t=e.btn_label,a=e.btn_css,n=e.isDisabled,s=void 0!==n&&n,o=this.props.disableButton,i=void 0!==o&&o;return s?r.a.createElement("button",{className:"btn "+a},t," "):r.a.createElement("button",{className:"btn "+a,onClick:this.submit,disabled:i},t)}}]),t}(n.Component),he=Object(ae.b)((function(e){return e}),(function(e){return{updateTasks:function(t){return e(ne(t))},updateChoosenTasksFromManagerMode:function(t){return e(oe(t))}}}))((function(e){var t=e.reducerTasks.selectedTasksIDs_fromManagerMode,a={title:"Potwierd\u017a usuni\u0119cie wielu zdarze\u0144",btn_label:"Usu\u0144 wiele",btn_css:"btn-outline-danger btn-sm sorting-buttons-box_operationForManyTasksButton",action:function(){return function(){var a=e.reducerTasks.tasks,n=Object($.a)(a);t.forEach((function(e){var t,a;return g.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(!((t=n.findIndex((function(t){return t._id===e})))<0)){r.next=3;break}return r.abrupt("return");case 3:return n.splice(t,1),a={_id:e},r.next=7,g.a.awrap(te.deleteTask(a));case 7:case"end":return r.stop()}}))})),e.updateTasks(n),e.updateChoosenTasksFromManagerMode([])}()}},n=!e.reducerTasks.chooseManyTasksMode||t.length<=0;return r.a.createElement(be,{form:a,disableButton:n})})),ve=Object(ae.b)((function(e){return e}),(function(e){return{updateTasks:function(t){return e(ne(t))},updateChoosenTasksFromManagerMode:function(t){return e(oe(t))}}}))((function(e){var t=e.reducerTasks.selectedTasksIDs_fromManagerMode,a={title:"Potwierd\u017a zamkni\u0119cie wielu zdarze\u0144",btn_label:"Zako\u0144cz wiele",btn_css:"btn-danger btn-sm sorting-buttons-box_operationForManyTasksButton",action:function(){return function(){var a=e.reducerTasks.tasks,n=Object($.a)(a);t.forEach((function(e){var t,a,r;return g.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:if(!((t=n.findIndex((function(t){return t._id===e})))<0)){s.next=3;break}return s.abrupt("return");case 3:if(!n[t].isDone){s.next=5;break}return s.abrupt("return");case 5:return(a=n[t]).isDone=!0,a.closedBy=W.getUserFromJWT().name,s.next=10,g.a.awrap(te.updateTask(a));case 10:r=s.sent,n[t]=r;case 12:case"end":return s.stop()}}))})),e.updateTasks(n),e.updateChoosenTasksFromManagerMode([])}()}},n=!e.reducerTasks.chooseManyTasksMode||t.length<=0;return r.a.createElement(be,{form:a,disableButton:n})})),_e=Object(ae.b)((function(e){return e}),(function(e){return{changeCurrentSortingStatuts:function(t){return e(re(t))}}}))((function(e){var t=Object(n.useState)(!1),a=Object(k.a)(t,2),s=a[0],o=a[1],i=[{label:"W trakcie",path:!1},{label:"Zako\u0144czone",path:!0},{label:"Wszystkie",path:"All"}],c=function(t){o(t),e.changeCurrentSortingStatuts(t)};var u=e.reducerServiceMode.managerMode;return r.a.createElement("div",{className:"sorting-buttons-box"},!u&&r.a.createElement("p",{className:"sorting-buttons-box_paragraph"},"Poka\u017c zdarzenia:"),!u&&i.map((function(e){return r.a.createElement("button",{key:e.label,className:(t=e.path,(t===s?"btn-secondary":"btn-outline-secondary")+"  btn btn-sm sorting-buttons-box_sortingButton"),onClick:function(){return c(e.path)}},e.label);var t})),function(){var t=e.reducerServiceMode,a=t.serviceMode,n=t.serviceMode_jobName,r=W.isCurrentUserGreaterThanORequalTo("Kierownik");return a?W.isThisJobManaging(n):r}()&&r.a.createElement(pe,null),u&&r.a.createElement(fe,null),u&&r.a.createElement(ve,null),u&&r.a.createElement(he,null))})),ge=a(435),ke=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(l.a)(t).call(this,e))).form_confirmAlert={title:"Wylogowanie",btn_label:r.a.createElement("i",{className:"fa fas fa-sign-out"}),btn_css:"btn btn-outline-secondary btn-sm",action:function(){return a.logout()}},a.logout=function(){return g.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.a.awrap(W.logoutUser());case 3:a.props.toggleServiceMode(!1),a.props.toggleManagerMode(!1),a.props.changeServiceMode_jobName("Admin"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),b.toast.error("Wyst\u0105pi\u0142 b\u0142\u0105d podczas wylogowania");case 11:return e.prev=11,localStorage.clear(),a.props.history.push(K.home),e.finish(11);case 15:case"end":return e.stop()}}),null,null,[[0,8,11,15]])},a.handleInputOnChange=function(e){var t=e.currentTarget,n=Object(T.a)({},a.state.user);n[t.name]=t.value,a.setState({user:n})},a.state={user:W.getUserFromJWT()},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=W.getUserFromJWT();this.setState({user:e})}},{key:"render_pLabel",value:function(){var e=this.state.user.name,t=e.indexOf(" ")-1;return t<0&&"a"===e[t]?"Jeste\u015b zalogowana jako:":"Jeste\u015b zalogowany jako:"}},{key:"render",value:function(){var e=this.state.user,t=W.isCurrentUserGreaterThan("Koordynator")?"":"display-flex";return r.a.createElement("div",{className:"logout-button-box"},r.a.createElement("div",{className:"logout-button-box__info "+t},r.a.createElement("p",null,this.render_pLabel()),r.a.createElement(y.a,{to:K.settings.user},r.a.createElement("p",{style:{textTransform:"capitalize"}},e.name))),r.a.createElement(be,{item:e,itemRepresentation:"Czy chcesz si\u0119 wylogowa\u0107?",form:this.form_confirmAlert}))}}]),t}(n.Component),ye=Object(ae.b)((function(e){return e}),(function(e){return{toggleServiceMode:function(t){return e(ce(t))},toggleManagerMode:function(t){return e(le(t))},changeServiceMode_jobName:function(t){return e(ue(t))}}}))(Object(ge.a)(ke)),Ee=a(96),we=a(97),xe=Object(ae.b)((function(e){return e}),(function(e){return{updateTasks:function(t){return e(ne(t))}}}))((function(e){var t=W.getUserFromJWT();return r.a.createElement(be,{item:e.task,itemRepresentation:e.task.content,form:function(a){var n=a.takedBy===t.name,s=n&&!a.isDOne?"btn-info btn-sm":"btn-outline-secondary btn-sm",o=n?"Obs\u0142ugujesz":a.takedBy?"Przejmij":"Bior\u0119 zlecenie",i=n?"T":a.takedBy?"P":"B",c=a.takedBy?a.takedBy!==t.name?"Potwierd\u017a przej\u0119cie zlecenia":"":"Potwierd\u017a przyj\u0119cie zlecenia",u=a.takedBy?s:"btn-warning btn-sm";return{title:c,btn_label:r.a.createElement("p",null,r.a.createElement("span",{className:"task-box_btn-label_full"},o),r.a.createElement("span",{className:"task-box_btn-label_short"},i)),btn_css:u,isDisabled:n,action:function(t){return function(t){var a,n,r,s;return g.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return t.takedBy=W.getUserFromJWT().name,a=e.reducerTasks.tasks,o.next=4,g.a.awrap(te.updateTask(t));case 4:n=o.sent,r=Object($.a)(a),s=r.findIndex((function(e){return e._id===n._id})),r[s]=n,e.updateTasks(r);case 9:case"end":return o.stop()}}))}(t)}}}(e.task)})})),Te=Object(ae.b)((function(e){return e}),(function(e){return{updateTasks:function(t){return e(ne(t))}}}))((function(e){var t={title:"Potwierd\u017a zako\u0144czenie zdarzenia",btn_css:"btn-danger btn-sm",action:function(t){return function(t){var a,n,r,s;return g.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return t.isDone=!0,t.closedBy=W.getUserFromJWT().name,o.next=4,g.a.awrap(te.updateTask(t));case 4:a=o.sent,n=e.reducerTasks.tasks,r=Object($.a)(n),s=r.findIndex((function(e){return e._id===a._id})),r[s]=a,e.updateTasks(r);case 10:case"end":return o.stop()}}))}(t)},btn_label:r.a.createElement("p",null,r.a.createElement("span",{className:"task-box_btn-label_full"},"Zako\u0144cz"),r.a.createElement("span",{className:"task-box_btn-label_short"},"Z"))};return r.a.createElement(be,{item:e.task,itemRepresentation:e.task.content,form:t})})),je=Object(ae.b)((function(e){return e}),(function(e){return{updateTasks:function(t){return e(ne(t))}}}))((function(e){var t={title:"Potwierd\u017a usuni\u0119cie zdarzenia z rejestru",btn_label:r.a.createElement("p",null,r.a.createElement("span",{className:"task-box_btn-label_full"},"Usu\u0144"),r.a.createElement("span",{className:"task-box_btn-label_short"},"X")),btn_css:"btn-outline-danger btn-sm",action:function(t){return function(t){var a,n,r,s;return g.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,g.a.awrap(te.deleteTask(t));case 2:a=o.sent,n=e.reducerTasks.tasks,r=Object($.a)(n),s=r.findIndex((function(e){return e._id===a._id})),r.splice(s,1),e.updateTasks(r);case 8:case"end":return o.stop()}}))}(t)}};return r.a.createElement(be,{item:e.task,itemRepresentation:e.task.content,form:t})})),Oe=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(a=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(s)))).state={},a.schema={partialQty:O.a.number().min(1).max(99999).required().error((function(){return{message:a.errorMessage}}))},a.inputValue=0,a.originalPartialQty=0,a.errorMessage="Podana ilo\u015b\u0107 musi by\u0107 okre\u015blona jako liczba i mie\u015bci\u0107 si\u0119 w zakresie 1-9999.",a.handleInputOnChange_partialDelivery=function(e){var t=e.currentTarget;a.inputValue=t.value},a.confirmGreaterDeliveryThanOrder=function(e){Object(N.confirmAlert)({title:"Ostrze\u017cenie!",message:"\u0141\u0105czna dostawa b\u0119dzie wi\u0119ksza ni\u017c zam\xf3wienie. Zatwierd\u017a dostaw\u0119 lub j\u0105 odrzu\u0107.",buttons:[{label:"Zatwierdzam",onClick:function(){e.partialQty+=parseInt(a.inputValue),a.props.form.action(e)}},{label:"Odrzucam",onClick:function(){}}]})},a.submit=function(){a.resetTaskData(),Object(N.confirmAlert)({customUI:function(e){var t=e.onClose,n=a.props.form.title;return r.a.createElement("div",{className:"confirmAlertInput"},r.a.createElement("h1",null,n),r.a.createElement("div",{className:"confirmAlertInput__input-box"},a.renderInputBoxGroup("Ilo\u015b\u0107","partialQty","number","Podaj ilo\u015b\u0107 jak\u0105 teraz dostarczasz",t,"autoFocus",a.handleInputOnChange_partialDelivery)),r.a.createElement("div",null,r.a.createElement("p",null,"* Podana warto\u015b\u0107 zostanie dodana do sumy zrealizowanej dostawy.")),r.a.createElement("div",{className:"confirmAlertInput__button-group"},a.renderButton("Dodaj",(function(){return a.doSubmit(t)})),a.renderButton("Anuluj",t)))}})},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.originalPartialQty=this.props.task.partialQty,this.setState({item:this.props.task})}},{key:"resetTaskData",value:function(){this.inputValue=0}},{key:"doSubmit",value:function(e){var t=this.state.item,a=this.validate({partialQty:this.inputValue});if(a)return b.toast.error(a),null;e(),t.qty<t.partialQty+parseInt(this.inputValue)?this.confirmGreaterDeliveryThanOrder(t):(t.partialQty+=parseInt(this.inputValue),this.props.form.action(t))}},{key:"render",value:function(){return r.a.createElement("button",{className:"btn "+this.props.form.btn_css,onClick:this.submit},this.props.form.btn_label)}}]),t}(M),Ne=Object(ae.b)((function(e){return e}),(function(e){return{updateTasks:function(t){return e(ne(t))}}}))((function(e){var t={title:"Zarejestruj bierz\u0105c\u0105 dostaw\u0119",btn_css:"btn-primary btn-sm",action:function(t){return function(t){var a,n,r,s;return g.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return t.partialTime=0,a=e.reducerTasks.tasks,o.next=4,g.a.awrap(te.updateTask(t));case 4:n=o.sent,r=Object($.a)(a),s=r.findIndex((function(e){return e._id===n._id})),r[s]=n,e.updateTasks(r);case 9:case"end":return o.stop()}}))}(t)},btn_label:r.a.createElement("p",null,r.a.createElement("span",{className:"task-box_btn-label_full"},"Dostawa"),r.a.createElement("span",{className:"task-box_btn-label_short"},"D"))};return r.a.createElement(Oe,{task:e.task,form:t})})),Ce=function(e){var t=e.action,a=e.item,n=e.isChecked,s=e.isDisabled,o=void 0!==s&&s,i=n?"fa fas fa-check fa-check-yes":"fa fas fa-check fa-check-no";return r.a.createElement("button",{className:"custom-checkbox common-customCheckBox",disabled:o,onClick:function(){return t(a)}},r.a.createElement("i",{className:i}," "))},Me=Object(ae.b)((function(e){return e}),(function(e){return{updateChoosenTasksFromManagerMode:function(t){return e(oe(t))},updateTasks:function(t){return e(ne(t))}}}))((function(e){var t=e.reducerTasks,a=t.chooseManyTasksMode,n=t.selectedTasksIDs_fromManagerMode.includes(e.task._id),s=W.getUserFromJWT();var o=function(t){var a,n,r=e.reducerTasks.selectedTasksIDs_fromManagerMode,s=r.findIndex((function(e){return e===t._id}));s<0?(a=u,n=r,e.updateChoosenTasksFromManagerMode([].concat(Object($.a)(n),[a._id]))):function(t,a){var n=Object($.a)(a);n.splice(t,1),e.updateChoosenTasksFromManagerMode(n)}(s,r)};function i(){var t=e.reducerServiceMode,a=t.serviceMode_jobName,n=t.managerMode,o="Operator"===s.job||"Operator"===a,i="Magazynier"===s.job||"Magazynier"===a;if(o||i||n)return r.a.createElement(Te,{task:u})}function c(e,t,o){if("#"===t.path)return o;if("content"===t.path)return function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"task-box__task_content-text"},e.content),r.a.createElement("div",{className:"task-box__task_content-createdInFormatedData"},e.createdInFormatedData))}(e);if("qty"===t.path)return"order"===e.type?function(e){var t=e.partialQty?e.partialQty:0;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"task-box__task_qty-main"},e.qty),!e.isDone&&r.a.createElement("div",{className:"task-box__task_qty-partialDelivery"},"(",t,")"))}(e):"";if("partialQty"===t.path)return"order"===e.type?e.partialQty:"";if("location"===t.path)return e.location;if("time"===t.path)return e.time>=1400?"24h+":e.time;if("takedBy"===t.path)return function(e){return"order"===e.type||"orderTakeout"===e.type?e.takedBy||"?":e.createdBy}(e);if("btnClose"===t.path&&!e.isDone&&!a)return i();if("take"!==t.path||e.isDone){if("createdInFormatedData"===t.path)return e.createdInFormatedData;if("btnDelete"===t.path)return a?r.a.createElement(Ce,{isChecked:n,action:function(){}}):r.a.createElement(je,{task:e})}else{if("order"===e.type&&e.takedBy===s.name)return r.a.createElement(Ne,{task:e});if("order"===e.type||"orderTakeout"===e.type)return r.a.createElement(xe,{task:e})}}var u=e.task,l=e.columns,d=e.index;return r.a.createElement("div",{className:"task-box__task "+function(e){return e.isUrgent&&!e.isDone?"priority-task":e.isDone?"task-box__task-color_ok":e.partialTime>=10||"breakdown"===e.type?"task-box__task-color_ng":"modelChange"===e.type||"cleaning"===e.type?"task-box__task-color_warning":""}(u),onClick:function(){a&&o(u)},onDoubleClick:function(){return function(t){var a,n,r,s,o;return g.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(!t.isDone){i.next=2;break}return i.abrupt("return");case 2:return a=Object(T.a)({},t,{isUrgent:!t.isUrgent}),i.next=5,g.a.awrap(te.updateTask(a));case 5:n=i.sent,r=e.reducerTasks.tasks,s=Object($.a)(r),o=s.findIndex((function(e){return e._id===n._id})),s[o]=n,e.updateTasks(s);case 11:case"end":return i.stop()}}))}(u)}},l.map((function(e){return r.a.createElement("div",{key:u._id+e.path,className:C.getCustomTaskCss(e.path,"task")},c(u,e,d))})))})),ze=Object(ae.b)((function(e){return e}))((function(e){var t="UTRZYMANIE RUCHU"===e.reducerLocalisations.currentLocalisation.name?" invisible":"",a=function(e){return"qty"===e.path?t:""},n="warning-urgetTask "+(e.reducerTasks.tasks.find((function(e){return e.isUrgent&&!e.isDone}))?"display-block":"display-none");return r.a.createElement("div",{className:"task-box__header"},r.a.createElement("div",{className:n},"!"),e.columns.map((function(e){return r.a.createElement("div",{key:e.path,className:C.getCustomTaskCss(e.path,"header")+a(e)},e.label)})))})),Ue=Object(ae.b)((function(e){return e}))((function(e){var t={reducerTasks:e.reducerTasks,reducerLocalisations:e.reducerLocalisations,reducerServiceMode:e.reducerServiceMode},a=e.data,n=te.getSortedData(a,t),s=te.getFilteredColumns({common:[{label:"#",path:"#"},{label:"Zdarzenie",path:"content"},{label:"Ilo\u015b\u0107",path:"qty"},{label:"Dostarczono",path:"partialQty"},{label:"Miejsce",path:"location"},{label:"Czas",path:"time"}],special:{column_take:{label:"",path:"take"},column_btnClose:{label:"",path:"btnClose"},column_createdInFormatedData:{label:"Data rejestracji",path:"createdInFormatedData"},column_takedBy:{label:"Obs\u0142uguje",path:"takedBy"},column_btnDelete:{label:"",path:"btnDelete"}}},t);return r.a.createElement("div",{className:"task-box"},r.a.createElement(ze,{columns:s}),r.a.createElement(Ee.a,null,(function(e){var t=e.height,a=e.width;return r.a.createElement(we.a,{itemData:n,height:t-30,width:a,itemCount:n.length,itemSize:43},(function(e){var t=e.data,a=e.index,n=e.style,o=t[a];return r.a.createElement("div",{style:Object(T.a)({},n)},r.a.createElement(Me,{key:o._id,index:a+1,task:o,columns:s}))}))})))})),Ie=function(){return r.a.createElement("div",{className:"common__loader_box"},r.a.createElement("div",{className:"common__loader_box_loader"}))},Se=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).state={data:[]},a.interval_cdm_refreshingData="",a.onFocus=function(){a.mounted=!0,a.interval_onFocus_refreshingData=a.set_interval_refreshData()},a.onBlur=function(){a.remove_intervals_refreshData()},a.onHideApp=function(){return g.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:if("visible"!==document.visibilityState){e.next=13;break}if(e.t0=a.mounted,!e.t0){e.next=9;break}return e.t1=a,e.next=6,g.a.awrap(te.getTasks());case 6:e.t2=e.sent,e.t3={data:e.t2},e.t1.setState.call(e.t1,e.t3);case 9:a.remove_intervals_refreshData(),a.interval_onHideApp_refreshingData=a.set_interval_refreshData(),e.next=14;break;case 13:"hidden"===document.visibilityState&&a.remove_intervals_refreshData();case 14:case"end":return e.stop()}}))},a.set_interval_refreshData=function(){return window.setInterval((function(){var e;return g.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.a.awrap(a.getTasksFromDB_updateReducerState());case 2:e=t.sent,a.mounted&&a.setState({data:e});case 4:case"end":return t.stop()}}))}),1e4)},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e,t,a,n;return g.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return this.mounted=!0,this.redirectIfNeeded(),this.setActivityDetection(),r.prev=3,e=this.props.location.pathname,r.next=7,g.a.awrap(X.getCurrentLocalisation(e));case 7:if(t=r.sent,this.props.changeCurrentLocalisation(t),null===(a=this.props.reducerTasks.tasks)){r.next=14;break}r.t0=a,r.next=17;break;case 14:return r.next=16,g.a.awrap(this.getTasksFromDB_updateReducerState());case 16:r.t0=r.sent;case 17:n=r.t0,this.mounted&&this.setState({data:n}),r.next=24;break;case 21:r.prev=21,r.t1=r.catch(3),r.t1.response&&b.toast.error("Problem z pobraniem danych z serwera.");case 24:this.interval_cdm_refreshingData=this.set_interval_refreshData();case 25:case"end":return r.stop()}}),null,this,[[3,21]])}},{key:"getTasksFromDB_updateReducerState",value:function(){var e;return g.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.a.awrap(te.getTasks());case 2:return e=t.sent,this.props.updateTasks(e),t.abrupt("return",e);case 5:case"end":return t.stop()}}),null,this)}},{key:"componentWillUnmount",value:function(){this.mounted=!1,this.remove_intervals_refreshData(),this.removeActivityDetection()}},{key:"setActivityDetection",value:function(){window.addEventListener("visibilitychange",this.onHideApp),window.addEventListener("focus",this.onFocus),window.addEventListener("blur",this.onBlur)}},{key:"removeActivityDetection",value:function(){window.removeEventListener("visibilitychange",this.onHideApp),window.removeEventListener("focus",this.onFocus),window.removeEventListener("blur",this.onBlur)}},{key:"remove_intervals_refreshData",value:function(){this.mounted=!1,clearInterval(this.interval_cdm_refreshingData),clearInterval(this.interval_onFocus_refreshingData),clearInterval(this.interval_onHideApp_refreshingData)}},{key:"redirectIfNeeded",value:function(){var e,t;return g.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return e=W.getUserFromJWT().isCommonUser,t=W.isCurrentUserLessThan("Koordynator")&&!e,a.next=4,g.a.awrap(X.getSelectedLocalisation(this.props.match.params.id));case 4:!a.sent&&t?this.props.history.push(K.selectLocalisation):t||this.props.history.push(K.tasks.main);case 6:case"end":return a.stop()}}),null,this)}},{key:"render",value:function(){var e=this.state.data;return r.a.createElement(r.a.Fragment,null,r.a.createElement(me,null),r.a.createElement("div",{className:"app__content"},r.a.createElement("div",{className:"app__container-buttons"},r.a.createElement(_e,null),r.a.createElement(ye,null)),e&&0===e.length&&r.a.createElement(Ie,null),e&&r.a.createElement(Ue,{data:e})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.reducerTasks.tasks!==t.tasks?{data:e.reducerTasks.tasks}:e.reducerServiceMode.serviceMode!==t.serviceMode?{serviceMode:e.reducerServiceMode.tasks}:e.reducerServiceMode.serviceMode_jobName!==t.serviceMode_jobName?{serviceMode_jobName:e.reducerServiceMode.tasks}:null}}]),t}(n.Component),De=Object(ae.b)((function(e){return e}),(function(e){return{updateTasks:function(t){return e(ne(t))},changeCurrentLocalisation:function(t){return e(de(t))}}}))(Se),Le=a(180),Pe=a.n(Le),Ae=I.getTasksInExcelFile;function Fe(){var e=(new Date).getTime(),t=new Date(e- -72e5).toISOString();return"FILMAG-Wykaz zdarze\u0144 - "+t.slice(0,10)+"-"+t.slice(11,13)+t.slice(14,16)+t.slice(17,19)+".xlsx"}var Be={getTasksInExcelFile:function(){var e,t,a,n;return g.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,e=Fe(),r.next=4,g.a.awrap(F.get(Ae,{responseType:"arraybuffer"}));case 4:t=r.sent,a=t.data,n=new Blob([a],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet; base64"}),Pe.a.saveAs(n,e),r.next=13;break;case 10:r.prev=10,r.t0=r.catch(0),b.toast.error("Nie mo\u017cna \u015bci\u0105gn\u0105\u0107 pliku.");case 13:case"end":return r.stop()}}),null,null,[[0,10]])}};function Re(){Be.getTasksInExcelFile()}var qe=function(e){var t=e.validLocations,a=W.isCurrentUserGreaterThanORequalTo("Koordynator");return r.a.createElement("header",{className:"app__header"},r.a.createElement("div",{className:"app__header-title"},"Ustawienia"),a&&r.a.createElement("div",{className:"app__header-barIcon"},r.a.createElement("i",{className:"fa fas fa-bars fa-3x"}),r.a.createElement("ul",{className:"app__header-menu"},r.a.createElement(E,{label:"Wy\u015bwietl zdarzenia",path:"/show-data",icon:"fa-align-justify"}),r.a.createElement(x,{items:t,action:function(){return null}}),r.a.createElement("li",{className:"app__header-menu_item app__header-menu_item-option",onClick:Re},r.a.createElement("i",{className:"fa fa-download"}),"Pobierz zdarzenia do excel"))))},Ge=function(e){var t=e.label,a=e.path,n=e.css,s=void 0===n?"btn btn-secondary btn-sm":n;return r.a.createElement(y.a,{to:a},r.a.createElement("button",{className:s},t))},Je=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(a=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(s)))).state={},a.submit=function(){Object(N.confirmAlert)({customUI:function(e){var t=e.onClose,n=a.props.form,s=n.title,o=n.p_label,i=n.p_label_2,c=n.placeholder_1,u=n.placeholder_2,l=n.input_1_type,d=void 0===l?"text":l,m=n.name_1,p=void 0===m?"name":m,f=n.name_2;return r.a.createElement("div",{className:"confirmAlertInput"},r.a.createElement("h1",null,s),r.a.createElement("div",{className:"confirmAlertInput__input-box"},a.renderInputBoxGroup(o,p,d,c,t,"autoFocus"),i&&a.renderInputBoxGroup(i,f,"text",u,t)),r.a.createElement("div",{className:"confirmAlertInput__button-group"},a.renderButton("Dodaj",(function(){return a.doSubmit(t)})),a.renderButton("Anuluj",t)))}})},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"doSubmit",value:function(e){var t=this.state.item;this.props.form.action(t),e()}},{key:"render",value:function(){var e=this.props.form,t=e.btn_css,a=e.btn_label;return this.renderButton(a,this.submit,t)}}]),t}(M),We=function(e){var t=e.options,a=e.currentValue,n=e.item,s=e.isDisabled,o=void 0!==s&&s,i=e.onChange;return r.a.createElement("div",null,r.a.createElement("select",{className:"custom-select","data-style":"btn-primary",name:n,onChange:i,value:a,disabled:o},t.map((function(e){return r.a.createElement("option",{key:e,value:e},e)}))))},Ke=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).state={},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.user,a=e.columns,n=e.renderCellContent;return r.a.createElement("div",{className:"user__wrapper"},r.a.createElement("div",{key:t._id,className:"user"},a.map((function(e){return r.a.createElement("div",{key:t._id+e.path,className:"user__content"},n(t,e))}))))}}]),t}(n.PureComponent),He=function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).call(this))).state={users:[]},e.form_deleteUser={title:"Potwierd\u017a usuni\u0119cie konta",btn_label:r.a.createElement("p",null,r.a.createElement("span",{className:"user__content_btn-label_full"},"Usu\u0144 konto"),r.a.createElement("span",{className:"user__content_btn-label_short"},"X")),btn_css:"btn btn-danger btn-sm",action:function(t){return e.handleDeleteUser(t)}},e.form_resetPassword={title:"Resetowanie has\u0142o",btn_label:r.a.createElement("p",null,r.a.createElement("span",{className:"user__content_btn-label_full"},"Resetuj has\u0142o"),r.a.createElement("span",{className:"user__content_btn-label_short"},"R")),message:"Resetujesz has\u0142o u\u017cytkownika. Nowe has\u0142o: 12345.",btn_css:"btn btn-secondary btn-sm",action:function(t){return e.handleResetPassword(t)}},e.form_addteUser={title:"Dodaj konto u\u017cytkownika",p_label:"Login",btn_label:"Dodaj nowe konto",placeholder_1:"Podaj nazw\u0119 u\u017cytkownika",btn_css:"btn btn-success btn-sm",action:function(t){return e.handleAddUser(t)}},e.columns=[{label:"#",path:"#"},{label:"Pracownik",path:"name"},{label:"Stanowisko",path:"userJob"},{label:r.a.createElement("i",{className:"fa fas fa-desktop"}),path:"status"},{label:r.a.createElement("div",null,r.a.createElement("span",{className:"user__content_btn-label_full"},"Magazyn"),r.a.createElement("span",{className:"user__content_btn-label_short"},"MG")),path:"Magazyn"},{label:r.a.createElement("div",null,r.a.createElement("span",{className:"user__content_btn-label_full"},"Maszyny"),r.a.createElement("span",{className:"user__content_btn-label_short"},"MS")),path:"Maszyny"},{label:r.a.createElement("div",null,r.a.createElement("span",{className:"user__content_btn-label_full"},"Utrzymanie ruchu"),r.a.createElement("span",{className:"user__content_btn-label_short"},"UR")),path:"Utrzymanie ruchu"},{label:"",path:"btn-reset"}],e.options=W.getJobNames(),e.schema={name:O.a.string().min(5).required().error((function(){return{message:"Podana nazwa jest za kr\xf3tka. Minimum to 5 znak\xf3w."}})),password:O.a.string().min(5).required().error((function(){return{message:"Podane has\u0142o jest za kr\xf3tkie. Minimum to 5 znak\xf3w."}}))},e.handleDeleteUser=function(t){var a,n,r;return g.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,g.a.awrap(W.deleteUser(t));case 3:if(a=s.sent,n=Object($.a)(e.state.users),!((r=n.findIndex((function(e){return e._id===a._id})))<0)){s.next=8;break}return s.abrupt("return");case 8:n.splice(r,1),e.setState({users:n}),s.next=15;break;case 12:s.prev=12,s.t0=s.catch(0),s.t0&&s.t0.response&&b.toast.error(s.t0.response.data);case 15:case"end":return s.stop()}}),null,null,[[0,12]])},e.handleAddUser=function(t){var a,n,r,s;return g.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(o.prev=0,a={name:t.name,password:"12345"},!(n=e.validateNewUser(a))){o.next=6;break}return b.toast.error(n),o.abrupt("return",null);case 6:return o.next=8,g.a.awrap(W.addUser(a));case 8:r=o.sent,(s=Object($.a)(e.state.users)).unshift(r),e.setState({users:s}),o.next=17;break;case 14:o.prev=14,o.t0=o.catch(0),o.t0&&o.t0.response&&b.toast.error(o.t0.response.data);case 17:case"end":return o.stop()}}),null,null,[[0,14]])},e.handleResetPassword=function(e){return g.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,g.a.awrap(W.resetUserPassword({_id:e._id,password:"12345"}));case 3:b.toast.info("Zmieniono has\u0142o u\u017cytkownika."),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),t.t0&&t.t0.response&&b.toast.error(t.t0.response.data);case 9:case"end":return t.stop()}}),null,null,[[0,6]])},e.updateUserPermissions=function(t){var a,n,r,s,o,i;return g.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return a=t.user,n=t.area,r=e.chamgeUserPermisions(a,n),c.next=4,g.a.awrap(W.updateUser(r));case 4:s=c.sent,o=Object($.a)(e.state.users),i=o.findIndex((function(e){return e._id===s._id})),o[i]=s,e.setState({users:o});case 9:case"end":return c.stop()}}))},e.handleInputOnChange=function(t){var a,n,r,s;return g.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return a=t.currentTarget,n=Object($.a)(e.state.users),r=n.findIndex((function(e){return e._id===a.name})),(s=n[r]).job=a.value,"Wsp\xf3\u0142dzielone"===a.value?s.isCommonUser=!0:s.isCommonUser=!1,o.next=8,g.a.awrap(W.updateUser(s));case 8:n[r]=o.sent,e.setState({users:n});case 10:case"end":return o.stop()}}))},e.renderCellContent=function(t,a){var n=e.state.users;return"#"===a.path?n.indexOf(t)+1:"name"===a.path?t.name:"userJob"===a.path?e.renderInputCustomSelect(t):"status"===a.path?e.renderUserStatus(t):"Magazyn"===a.path?e.renderCheckBox(t,"Magazyn"):"Maszyny"===a.path?e.renderCheckBox(t,"Maszyna"):"Utrzymanie ruchu"===a.path?e.renderCheckBox(t,"Utrzymanie ruchu"):t.isDone||"btn-reset"!==a.path?t.isDone||"btn-delete"!==a.path?void 0:e.renderButton(t,e.form_deleteUser):e.renderButton(t,e.form_resetPassword)},W.isCurrentUserGreaterThanORequalTo("Admin")&&e.columns.push({label:"",path:"btn-delete"}),e}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){return g.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=this,e.next=3,g.a.awrap(W.getUsers());case 3:e.t1=e.sent,e.t2={users:e.t1},e.t0.setState.call(e.t0,e.t2);case 6:case"end":return e.stop()}}),null,this)}},{key:"validateNewUser",value:function(e){var t=O.a.validate(e,this.schema).error;return t?t.details[0].message:null}},{key:"chamgeUserPermisions",value:function(e,t){var a=e.permissions.indexOf(t);return a>=0?e.permissions.splice(a,1):e.permissions.push(t),e}},{key:"selectOptions",value:function(e){var t=W.isCurrentUserLessThanORequalTo(e.job),a=Object($.a)(this.options),n=a.indexOf(W.getUserFromJWT().job);return t?[e.job]:a.splice(n+1)}},{key:"isChecked",value:function(e,t){return e.indexOf(t)>=0}},{key:"renderCheckBox",value:function(e,t){var a=this,n=W.isCurrentUserLessThanORequalTo(e.job);return r.a.createElement(Ce,{item:{user:e,area:t},isChecked:this.isChecked(e.permissions,t),isDisabled:n,action:function(e){return a.updateUserPermissions(e)}})}},{key:"renderUserStatus",value:function(e){return r.a.createElement("div",{className:"fa far fa-user"+(e.isLogged?" text-success":" text-muted")})}},{key:"renderButton",value:function(e,t){var a=W.isCurrentUserLessThanORequalTo(e.job);return r.a.createElement(be,{item:e,itemRepresentation:e.name,form:t,disableButton:a})}},{key:"renderInputCustomSelect",value:function(e){var t=W.isCurrentUserLessThanORequalTo(e.job);return r.a.createElement(We,{item:e._id,currentValue:e.job,isDisabled:t,options:this.selectOptions(e),onChange:this.handleInputOnChange})}},{key:"renderAddUserButton",value:function(){return r.a.createElement(Je,{form:this.form_addteUser})}},{key:"renderHeader",value:function(){return r.a.createElement("div",{className:"user user__header"},this.columns.map((function(e){return r.a.createElement("div",{key:e.path,className:"user__content"},e.label)})))}},{key:"renderUsers",value:function(){var e=this;return r.a.createElement(Ee.a,null,(function(t){var a=t.height,n=t.width;return r.a.createElement(we.a,{itemData:e.state.users,height:a-75,width:n,itemCount:e.state.users.length,itemSize:50},(function(t){var a=t.data,n=t.index,s=t.style,o=a[n];return r.a.createElement("div",{style:Object(T.a)({},s)},r.a.createElement(Ke,{user:o,columns:e.columns,renderCellContent:e.renderCellContent}))}))}))}},{key:"render",value:function(){var e=W.isCurrentUserGreaterThanORequalTo("Admin");return r.a.createElement("div",{className:"app__content"},r.a.createElement("div",{className:"app__container-buttons"},r.a.createElement("div",{className:"settings__switch-buttons"},r.a.createElement(Ge,{label:"Wy\u015bwietl zdarzenia",path:K.tasks.main,css:"btn btn-sm btn-primary"}),r.a.createElement(Ge,{label:"Lokalizacje",path:K.settings.localisations}),r.a.createElement(Ge,{label:"M\xf3j profil",path:K.settings.user}),e&&this.renderAddUserButton()),r.a.createElement(ye,null)),r.a.createElement("div",{className:"users"},this.renderHeader(),this.state.users&&0===this.state.users.length&&r.a.createElement(Ie,null),this.renderUsers()))}}]),t}(n.Component),Ze=function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).call(this))).state={localisations:[]},e.columns=[{label:"#",path:"#"},{label:"Nazwa",path:"name"},{label:"Kategoria",path:"category"}],e.options=[""].concat(Object($.a)(X.getLocalisationNames())),e.form_confirmAlert={title:"Potwierd\u017a usuni\u0119cie lokalizacji",btn_label:r.a.createElement("p",null,r.a.createElement("span",{className:"localisation__content_btn-label_full"},"Usu\u0144 lokalizacj\u0119"),r.a.createElement("span",{className:"localisation__content_btn-label_short"},"X")),btn_css:"btn-danger btn-sm",action:function(t){return e.handleDeleteLocalisation(t)}},e.form_addLocalisation={title:"Dodaj now\u0105 lokalizacj\u0119",p_label:"Nazwa",placeholder_1:"Podaj nazw\u0119 lokalizacji",btn_label:"Dodaj now\u0105 lokalizacj\u0119",btn_css:"btn btn-success btn-sm",action:function(t){return e.handleAddLocalisation(t)}},e.schema={name:O.a.string().min(1).max(255).required().error((function(){return{message:"Podana nazwa jest za kr\xf3tka. Minimum to 1 znak."}}))},e.handleDeleteLocalisation=function(t){var a,n,r;return g.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,g.a.awrap(X.deleteLocalisation(t));case 3:if(a=s.sent,n=e.state.localisations,!((r=n.findIndex((function(e){return e._id===a._id})))<0)){s.next=8;break}return s.abrupt("return");case 8:n.splice(r,1),e.setState({localisations:n}),s.next=15;break;case 12:s.prev=12,s.t0=s.catch(0),s.t0&&s.t0.response&&b.toast.error(s.t0.response.data);case 15:case"end":return s.stop()}}),null,null,[[0,12]])},e.handleAddLocalisation=function(t){var a,n,r;return g.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:if(s.prev=0,!(a=e.validateNewLocalisation(t))){s.next=5;break}return b.toast.error(a),s.abrupt("return",null);case 5:return s.next=7,g.a.awrap(X.addLocalisation(t));case 7:n=s.sent,(r=e.state.localisations).unshift(n),e.setState({localisations:r}),s.next=16;break;case 13:s.prev=13,s.t0=s.catch(0),s.t0&&s.t0.response&&b.toast.error(s.t0.response.data);case 16:case"end":return s.stop()}}),null,null,[[0,13]])},e.handleInputOnChange=function(t){var a,n,r,s,o;return g.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return a=t.currentTarget,i.prev=1,n=Object($.a)(e.state.localisations),r=n.findIndex((function(e){return e._id===a.name})),(s=n[r]).category=a.value,i.next=8,g.a.awrap(X.updateLocalisation(s));case 8:n[r]=i.sent,o=X.sortLocalisationsOrder(n),X.setUserLocalisations(o),e.setState({localisations:o}),i.next=17;break;case 14:i.prev=14,i.t0=i.catch(1),i.t0&&i.t0.response&&b.toast.error(i.t0.response.data);case 17:case"end":return i.stop()}}),null,null,[[1,14]])},e.renderCellContent=function(t,a){var n=e.state.localisations,r=e.form_confirmAlert;return"#"===a.path?n.indexOf(t)+1:"name"===a.path?t.name:"category"===a.path?e.renderInputCustomSelect(t):"btn-delete"===a.path?e.renderConfirmAlert(t,r):void 0},W.isCurrentUserGreaterThanORequalTo("Admin")&&e.columns.push({label:"",path:"btn-delete"}),e}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){return g.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=this,e.next=3,g.a.awrap(X.getLocalisations());case 3:e.t1=e.sent,e.t2={localisations:e.t1},e.t0.setState.call(e.t0,e.t2);case 6:case"end":return e.stop()}}),null,this)}},{key:"validateNewLocalisation",value:function(e){var t=O.a.validate(e,this.schema).error;return t?t.details[0].message:null}},{key:"renderInputCustomSelect",value:function(e){return r.a.createElement(We,{item:e._id,currentValue:e.category,options:this.options,onChange:this.handleInputOnChange})}},{key:"renderConfirmAlert",value:function(e,t){return r.a.createElement(be,{item:e,itemRepresentation:e.name,form:t})}},{key:"renderAddLocalisationButton",value:function(){return r.a.createElement(Je,{form:this.form_addLocalisation})}},{key:"renderHeader",value:function(e,t,a){return r.a.createElement("div",{className:t},e.map((function(e){return r.a.createElement("div",{key:e.path,className:a},e.label)})))}},{key:"renderLocalisations",value:function(e,t,a,n){var s=this;return r.a.createElement("div",{className:t},e.map((function(e){return r.a.createElement("div",{key:e._id,className:a},s.columns.map((function(t){return r.a.createElement("div",{key:e._id+t.path,className:n},s.renderCellContent(e,t))})))})))}},{key:"render",value:function(){var e=W.isCurrentUserGreaterThanORequalTo("Admin"),t=this.state.localisations;return r.a.createElement("div",{className:"app__content"},r.a.createElement("div",{className:"app__container-buttons"},r.a.createElement("div",{className:"settings__switch-buttons"},r.a.createElement(Ge,{label:"Wy\u015bwietl zdarzenia",path:K.tasks.main,css:"btn btn-sm btn-primary"}),r.a.createElement(Ge,{label:"U\u017cytkownicy",path:K.settings.users}),r.a.createElement(Ge,{label:"M\xf3j profil",path:K.settings.user}),e&&this.renderAddLocalisationButton()),r.a.createElement(ye,null)),r.a.createElement("div",{className:"localisations"},this.renderHeader(this.columns,"localisation localisation__header","localisation__content"),t&&0===t.length&&r.a.createElement(Ie,null),this.renderLocalisations(t,"localisation__wrapper","localisation","localisation__content")))}}]),t}(n.Component),Ve=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).state={user:{}},a.form_resetPassword={title:"Zmie\u0144 has\u0142o",p_label:"Obecne",input_1_type:"password",name_1:"password",p_label_2:"Nowe",name_2:"newPassword",btn_label:"Zmie\u0144 has\u0142o",btn_css:"btn btn-outline-danger btn-sm",action:function(e){return a.handleResetPassword(e)}},a.form_resetPIN={title:"Zmie\u0144 PIN",p_label:"Has\u0142o",p_label_2:"Nowy PIN",input_1_type:"password",name_1:"password",name_2:"newPIN",placeholder_1:"Podaj obecne has\u0142o",placeholder_2:"Podaj nowe has\u0142o",btn_label:"Zmie\u0144 PIN",btn_css:"btn btn-outline-danger btn-sm",action:function(e){return a.handleResetPIN(e)}},a.errorMessage={password:"Podane has\u0142o jest za kr\xf3tkie. Minimum to 5 znak\xf3w",newPin:"Niepoprawna d\u0142ugo\u015b\u0107 PIN. ILo\u015b\u0107 znak\xf3w musi wynosi\u0107 4"},a.schemaPassword={password:O.a.string().min(5).required().error((function(){return{message:a.errorMessage.password}})),newPassword:O.a.string().min(5).required().error((function(){return{message:a.errorMessage.password}}))},a.schemaPIN={password:O.a.string().min(5).required().error((function(){return{message:a.errorMessage.password}})),newPIN:O.a.string().min(4).max(4).required().error((function(){return{message:a.errorMessage.newPin}}))},a.handleResetPassword=function(e){var t,n,r,s,o;return g.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(t=e.password,n=e.newPassword,r=Object(T.a)({},a.state.user),!(s=a.validateNewCredencials({password:t,newPassword:n},a.schemaPassword))){i.next=6;break}return b.toast.error(s),i.abrupt("return",null);case 6:return i.prev=6,i.next=9,g.a.awrap(W.resetUserPassword({_id:r._id,password:t,newPassword:n}));case 9:o=i.sent,L.setJwt(o),b.toast.success("Zaktualizowano has\u0142o"),a.setState({user:W.getUserFromJWT()}),i.next=18;break;case 15:i.prev=15,i.t0=i.catch(6),i.t0.response&&b.toast.error(i.t0.response.data);case 18:case"end":return i.stop()}}),null,null,[[6,15]])},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e;return g.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:e=W.getUserFromJWT(),this.setState({user:e});case 2:case"end":return t.stop()}}),null,this)}},{key:"handleResetPIN",value:function(e){var t,a,n,r,s;return g.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(t=e.password,a=e.newPIN,n=Object(T.a)({},this.state.user),!(r=this.validateNewCredencials({password:t,newPIN:a},this.schemaPIN))){o.next=6;break}return b.toast.error(r),o.abrupt("return",null);case 6:return o.prev=6,o.next=9,g.a.awrap(W.resetUserPIN({_id:n._id,password:t,newPIN:a}));case 9:s=o.sent,L.setJwt(s),this.setState({user:W.getUserFromJWT()}),b.toast.success("Zaktualizowano PIN"),o.next=18;break;case 15:o.prev=15,o.t0=o.catch(6),o.t0.response&&b.toast.error(o.t0.response.data);case 18:case"end":return o.stop()}}),null,this,[[6,15]])}},{key:"validateNewCredencials",value:function(e,t){var a=O.a.validate(e,t).error;return a?a.details[0].message:null}},{key:"renderSettingsNavigationButtons",value:function(){var e=K.settings;return r.a.createElement("div",{className:"settings__switch-buttons"},r.a.createElement(Ge,{label:"Wy\u015bwietl zdarzenia",path:K.tasks.main,css:"btn btn-sm btn-primary"}),r.a.createElement(Ge,{label:"U\u017cytkownicy",path:e.users}),r.a.createElement(Ge,{label:"Lokalizacje",path:e.localisations}))}},{key:"renderReturnButton",value:function(){return r.a.createElement("button",{className:"btn btn-sm btn-primary",onClick:this.props.history.goBack},"Powr\xf3\u0107 do wybranej lokalizacji")}},{key:"render",value:function(){var e=W.getUserFromJWT(),t=e.name,a=e.shortIdentifier,n=W.isCurrentUserGreaterThanORequalTo("Koordynator");return r.a.createElement("div",{className:"app__content"},r.a.createElement("div",{className:"app__container-buttons"},r.a.createElement("div",{className:"settings__switch-buttons"},!n&&this.renderReturnButton(),n&&this.renderSettingsNavigationButtons(),r.a.createElement("div",null)),r.a.createElement(ye,null)),r.a.createElement("div",{className:"settings__user-page"},r.a.createElement("div",{className:"settings__user-page_user_box"},r.a.createElement("h2",null,"Profil u\u017cytkownika"),r.a.createElement("div",{className:"settings__user-page_user_box__info-box_group"},r.a.createElement("p",null,"Login:"),r.a.createElement("div",{style:{textTransform:"capitalize"}},t)),r.a.createElement("div",{className:"settings__user-page_user_box__info-box_group"},r.a.createElement("p",null,"Has\u0142o :"),r.a.createElement("div",null,r.a.createElement(Je,{form:this.form_resetPassword}))),r.a.createElement("hr",{className:"border border-white"}),!e.isCommonUser&&r.a.createElement("div",null,r.a.createElement("div",{className:"settings__user-page_user_box__info-box_group"},r.a.createElement("p",null,"Kod Id :"),r.a.createElement("div",null,a.idCode)),r.a.createElement("div",{className:"settings__user-page_user_box__info-box_group"},r.a.createElement("p",null,"PIN :"),r.a.createElement("div",null,a.pin),r.a.createElement("div",null,r.a.createElement(Je,{form:this.form_resetPIN})))))))}}]),t}(n.Component),Qe=a(182),Xe=function(e){var t=e.path,a=e.requireUserLevel,n=e.redirectPath,s=e.component,o=e.render,i=Object(Qe.a)(e,["path","requireUserLevel","redirectPath","component","render"]);if(!W.getUserFromJWT())return r.a.createElement(f.a,{to:n});var c=W.isCurrentUserLessThan(a);return r.a.createElement(p.a,Object.assign({path:t},i,{render:function(e){return c?r.a.createElement(f.a,{to:n}):s?r.a.createElement(s,e):o(e)}}))},Ye=function(){var e=K.settings,t=[{label:"Wykaz u\u017cytkownik\xf3w",path:e.users},{label:"Wykaz lokalizacji",path:e.localisations},{label:"M\xf3j profil",path:e.user}];return r.a.createElement(r.a.Fragment,null,r.a.createElement(qe,{validLocations:t}),r.a.createElement(m.a,null,r.a.createElement(Xe,{path:e.localisations,requireUserLevel:"Koordynator",component:Ze,redirectPath:K.noPermissions}),r.a.createElement(Xe,{path:e.users,requireUserLevel:"Koordynator",component:He,redirectPath:K.noPermissions}),r.a.createElement(Xe,{path:e.user,requireUserLevel:"Operator",component:Ve,redirectPath:K.loginPage}),r.a.createElement(f.a,{from:e.main,to:e.users})))},$e=a(131),et=a.n($e),tt=(a(181),function(){return r.a.createElement("div",{className:"Advertisement"},r.a.createElement("div",{className:"Advertisement__logo-box"},r.a.createElement("img",{src:et.a,alt:"logoEduLEAN"})))}),at=function(){if(!W.getUserFromJWT())return r.a.createElement(f.a,{to:K.loginPage});var e=W.isCurrentUserGreaterThanORequalTo("Koordynator");return r.a.createElement(r.a.Fragment,null,r.a.createElement("header",{className:"app__header"},r.a.createElement("div",{className:"app__header-title"},"FILMAG")),r.a.createElement("div",{className:"app__content"},r.a.createElement("div",{className:"app__container-buttons"},r.a.createElement("div",{className:"settings__switch-buttons"},r.a.createElement(Ge,{label:"Wy\u015bwietl zdarzenia",path:K.tasks.main,css:"btn btn-sm btn-primary"}),e&&r.a.createElement(Ge,{label:"Przejd\u017a do ustawie\u0144",path:K.settings.users})),r.a.createElement(ye,null)),r.a.createElement(tt,null)))},nt=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).state={validLocalisations:[]},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=W.getUserFromJWT(),t=X.getCurrentUserLocalisations();e.isCommonUser?this.props.history.push(K.tasks.main):this.setState({validLocalisations:t})}},{key:"renderSelectLocalisationButtons",value:function(){var e=this.state.validLocalisations;return e.map((function(e){return r.a.createElement(Ge,{key:e.name,label:e.name,path:e.path,css:"btn btn-secondary btn-sm select-localisation__valid-localiation"})}))}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("header",{className:"app__header"},r.a.createElement("div",{className:"app__header-title"},"FILMAG")),r.a.createElement("div",{className:"app__content"},r.a.createElement("div",{className:"select-localisation"},r.a.createElement("h1",null,"Wybierz lokalizacj\u0119"),r.a.createElement("div",{className:"select-localisation__wrapper"},this.renderSelectLocalisationButtons()))))}}]),t}(n.Component),rt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(l.a)(t).call(this,e))).schema={name:O.a.string().min(1).required().error((function(){return{message:"Za kr\xf3tki login."}})),password:O.a.string().min(5).required().error((function(){return{message:"Za kr\xf3tkie has\u0142o."}}))},a.errorMessage="Obecnie Twoje konto nie posiada dost\u0119pu do \u017cadych lokalizacji. Zg\u0142o\u015b problem prze\u0142o\u017conemu lub adminowi.",a.handleInputOnChange=function(e){var t=e.currentTarget,n=Object(T.a)({},a.state.user);n[t.name]=t.value,a.setState({user:n})},a.handleLogin=function(){var e,t,n,r,s,o,i;return g.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:if(e=a.state.user,t=e.name,n=e.password,!(r=a.validateUser({name:t,password:n}))){c.next=5;break}return b.toast.error(r),c.abrupt("return",null);case 5:return a.runLoader(!0),c.prev=6,c.next=9,g.a.awrap(L.login(t,n));case 9:return s=c.sent,L.setJwt(s),F.setHeader_xAuthToken(s),o=W.getUserFromJWT(),c.next=15,g.a.awrap(X.getUserLocalisationsFromDB(o));case 15:i=c.sent,X.setUserLocalisations(i),a.redirectUserToNextPath(),c.next=24;break;case 20:c.prev=20,c.t0=c.catch(6),!c.t0.response||400!==c.t0.response.status&&403!==c.t0.response.status||b.toast.error(c.t0.response.data),a.runLoader(!1);case 24:case"end":return c.stop()}}),null,null,[[6,20]])},a.redirectUserToNextPath=function(){var e,t,n;return g.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(e=X.getCurrentUserLocalisations(),t=W.isCurrentUserGreaterThanORequalTo("Koordynator"),n=W.getUserFromJWT().isCommonUser,!t&&!n){r.next=7;break}a.props.history.push(K.tasks.main),r.next=17;break;case 7:if(!(e.length>1)){r.next=11;break}a.props.history.push(K.selectLocalisation),r.next=17;break;case 11:if(1!==e.length){r.next=15;break}a.props.history.push(e[0].path),r.next=17;break;case 15:return b.toast.error(a.errorMessage),r.abrupt("return",null);case 17:case"end":return r.stop()}}))},a.state={user:{name:"",password:""},isWaitingForSerwerResponse:!1},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"runLoader",value:function(e){var t=this.state.isWaitingForSerwerResponse;t=e,this.setState({isWaitingForSerwerResponse:t})}},{key:"validateUser",value:function(e){var t=O.a.validate(e,this.schema).error;return t?t.details[0].message:null}},{key:"renderLoginBox",value:function(){var e=this;return r.a.createElement("div",{className:"login-page_login_box"},r.a.createElement("h1",null,"Zaloguj si\u0119"),r.a.createElement("div",{className:"login-page_login_box__input-box"},r.a.createElement("div",{className:"login-page_login_box__input-box_group"},r.a.createElement("p",null,"Login"),r.a.createElement("input",{name:"name",autoComplete:"off",autoFocus:!0,onChange:this.handleInputOnChange,onKeyPress:function(t){return C.runFunctionAfterPressEnter(t,e.handleLogin)}}))),r.a.createElement("div",{className:"login-page_login_box__input-box"},r.a.createElement("div",{className:"login-page_login_box__input-box_group"},r.a.createElement("p",null,"Has\u0142o"),r.a.createElement("input",{name:"password",autoComplete:"off",type:"password",onChange:this.handleInputOnChange,onKeyPress:function(t){return C.runFunctionAfterPressEnter(t,e.handleLogin)}}))),r.a.createElement("div",{className:"login-page_login_box__button-group"},r.a.createElement("button",{onClick:this.handleLogin},"Zaloguj si\u0119")))}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("header",{className:"app__header"},r.a.createElement("div",{className:"app__header-title"},"FILMAG")),r.a.createElement("div",{className:"app__content"},r.a.createElement(tt,null),r.a.createElement("div",{className:"login-page"},this.state.isWaitingForSerwerResponse&&r.a.createElement(Ie,null),!this.state.isWaitingForSerwerResponse&&this.renderLoginBox())))}}]),t}(n.Component),st=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("header",{className:"app__header"}),r.a.createElement("div",{className:"app__content"},r.a.createElement("div",{className:"app__container-buttons"},r.a.createElement("div",null),r.a.createElement(ye,null)),r.a.createElement("div",{className:"no-permissions-box"},r.a.createElement("h2",null,"ODMOWA DOST\u0118PU"),r.a.createElement("p",null,"Nie posiadasz uprawnie\u0144 do przegl\u0105dania zawarto\u015bci tej strony."),r.a.createElement(Ge,{label:"Przejd\u017a do wyboru lokalizacji",path:K.selectLocalisation}))))},ot=72e5;function it(){"visible"===document.visibilityState&&ut()}function ct(){localStorage.setItem("lastActivityTime",(new Date).getTime())}function ut(){var e=localStorage.getItem("lastActivityTime",(new Date).getTime()),t=W.getUserFromJWT();if(e&&t&&(new Date).getTime()-e>ot)return localStorage.clear(),void(window.location="/");ct()}var lt={setActivityDetection:function(){window.addEventListener("load",ut),window.addEventListener("focus",ut),window.addEventListener("visibilitychange",it),window.addEventListener("unload",ct)},removeActivityDetection:function(){window.removeEventListener("load",ut),window.removeEventListener("focus",ut),window.removeEventListener("visibilitychange",it),window.removeEventListener("unload",ct)}},dt=(a(223),function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).state={},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){lt.setActivityDetection();try{var e=L.getJwt,t=v()(e);this.setState({user:t})}catch(a){}}},{key:"componentWillUnmount",value:function(){lt.removeActivityDetection()}},{key:"render",value:function(){return document.title="FILMAG",r.a.createElement("div",{className:"App"},r.a.createElement(b.ToastContainer,null),r.a.createElement(m.a,null,r.a.createElement(Xe,{path:K.tasks.paramId,requireUserLevel:"Operator",redirectPath:K.loginPage,component:De}),r.a.createElement(Xe,{path:K.tasks.main,requireUserLevel:"Operator",redirectPath:K.loginPage,component:De}),r.a.createElement(Xe,{path:K.selectLocalisation,requireUserLevel:"Operator",redirectPath:K.loginPage,component:nt}),r.a.createElement(Xe,{path:K.settings.main,requireUserLevel:"Operator",redirectPath:K.noPermissions,component:Ye}),r.a.createElement(Xe,{path:K.noPermissions,requireUserLevel:"Operator",redirectPath:K.loginPage,component:st}),r.a.createElement(p.a,{path:K.loginPage,component:rt}),this.state.user&&r.a.createElement(f.a,{to:K.tasks.main}),r.a.createElement(p.a,{path:K.home,component:at})))}}]),t}(n.Component)),mt=a(432);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(224),a(426),a(427),a(428);var pt=a(70),ft=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_TASKS":return Object(T.a)({},e,{tasks:t.tasks});case"CHANGE_CURRENT_SORTING_STATUS":return Object(T.a)({},e,{currentSortingStatus:t.currentSortingStatus});case"TOGGLE_CHOOSE_MANY_TASKS_MODE":return Object(T.a)({},e,{chooseManyTasksMode:t.chooseManyTasksMode});case"UPDATE_CHOOSED_TASKS_FROM_MANAGER_MODE":return Object(T.a)({},e,{selectedTasksIDs_fromManagerMode:t.selectedTasksIDs_fromManagerMode})}return e},bt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CHANGE_CURRENT_LOCALISATION":return Object(T.a)({},e,{currentLocalisation:t.currentLocalisation})}return e},ht=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE_SERVICE_MODE":return Object(T.a)({},e,{serviceMode:t.serviceMode});case"CHANGE_SERVICE_MODE_JOB_NAME":return Object(T.a)({},e,{serviceMode_jobName:t.serviceMode_jobName});case"TOGGLE_DELETE_TASK_MODE":return Object(T.a)({},e,{managerMode:t.managerMode})}return e},vt=Object(pt.b)({reducerTasks:ft,reducerLocalisations:bt,reducerServiceMode:ht}),_t=Object(pt.c)(vt,{reducerTasks:{tasks:null,currentSortingStatus:!1,chooseManyTasksMode:!1,selectedTasksIDs_fromManagerMode:[]},reducerLocalisations:{currentLocalisation:{name:"",category:"Magazyn"}},reducerServiceMode:{serviceMode:!1,serviceMode_jobName:"Admin",managerMode:!1}});window.store=_t,o.a.render(r.a.createElement(mt.a,{basename:"/"},r.a.createElement(ae.a,{store:_t},r.a.createElement(dt,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[183,1,2]]]);
//# sourceMappingURL=main.3f9d8e66.chunk.js.map